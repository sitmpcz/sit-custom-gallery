{"version":3,"sources":["sit-gallery-core.min.js"],"names":["$","jQuery","noConflict","SITg_app","self","this","$ajaxRemoveImages","$ajaxGetImages","confirmDelete","$window","window","$document","document","$body","$modalUploader","$dragDropZone","$filesList","inputFileList","$btnDelete","$btnDeleteAll","$selectSort","$imagePreviewList","sitgSortable","selectedItemsCache","init","prototype","onBind","bodyScrollClass","on","e","addClass","show","initUploader","preventDefault","dmUploader","$this","id","data","hasClass","closest","slideUp","remove","modalClose","vle","value","ajaxGetImages","editImageClose","find","fadeIn","ajaxEditImageHandler","keyCode","which","stopPropagation","editImageCacheTitle","keydown","cancelable","key","container","is","target","has","length","ajaxSetFeaturedImage","confirmDialogShow","action","trigger","confirmDialogHide","$items","ajaxRemoveImagesHandler","initSortable","destroy","Sortable","multiDrag","selectedClass","handle","filter","animation","onSelect","evt","items","onUpdate","url","sitg_ajax","ajax_url","extraData","_ajax_nonce","nonce","post_id","maxFileSize","max_upload_size","allowedTypes","extFilter","auto","queue","onDragEnter","onDragLeave","removeClass","onInit","ui_add_log","onComplete","uploaderToggleClass","onNewFile","file","validate","ui_multi_add_file","FileReader","reader","img","$del","onload","attr","result","readAsDataURL","onFileTypeError","name","onBeforeUpload","ui_multi_update_file_status","ui_multi_update_file_progress","onUploadCanceled","console","log","onUploadProgress","percent","onUploadSuccess","data_str","JSON","stringify","data_obj","parse","ajaxGetImage","file_id","onUploadError","xhr","status","message","onFallbackMode","onFileSizeError","template","fadeOut","text","replace","prop","prepend","color","active","bar","width","toggleClass","html","d","Date","dateString","getHours","slice","getMinutes","getSeconds","ajax","cache","dataType","pid","done","append","fail","jqXHR","textStatus","method","sort","img_ids","each","i","max","nextRemoveImg","$item","fadeTo","animate","height","onRemoveImgComplete","$parent","title","val","$el","response","$this_closest_handle","selected","$input","toggle","$template","state","css","display","scrollTop","offset","top","getHostname","m","match","ready"],"mappings":"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","file":"sit-gallery-core.min.js","sourcesContent":["var $ = jQuery.noConflict();\r\n\r\n(function ($) {\r\n\r\n    'use strict';\r\n\r\n    function SITg_app() {\r\n\r\n        var self = this;\r\n\r\n        self.$ajaxRemoveImages = false;\r\n        self.$ajaxGetImages = false;\r\n\r\n        self.confirmDelete = false;\r\n\r\n        self.$window = $(window);\r\n        self.$document = $(document);\r\n        self.$body = $(\"body\");\r\n\r\n        self.$modalUploader = $(\"#sitg-uploader\");\r\n        self.$dragDropZone = $(\"#drag-and-drop-zone\");\r\n        self.$filesList = $(\"#files\");\r\n        self.inputFileList = [];\r\n\r\n        self.$btnDelete = $(\".sitg-btn-delete\");\r\n        self.$btnDeleteAll = $(\".sitg-btn-delete-all\");\r\n        self.$selectSort = $(\"#sitg-sort\");\r\n\r\n        self.$imagePreviewList = $(\"#sitg-image-preview-list\");\r\n        self.sitgSortable = \"\";\r\n        self.selectedItemsCache = [];\r\n\r\n        self.init();\r\n\r\n    }\r\n\r\n    SITg_app.prototype = {\r\n\r\n        init: function () {\r\n\r\n            var self = this;\r\n\r\n            // Event handlers\r\n            self.onBind();\r\n\r\n            self.bodyScrollClass(self);\r\n\r\n        },\r\n\r\n        onBind: function(){\r\n\r\n            var self = this;\r\n\r\n            self.$window.on('scroll', function () {\r\n                self.bodyScrollClass(self);\r\n            });\r\n/*\r\n            self.$window.on(\"beforeunload\", function(e) {\r\n                // Kdyz se zmeni poradi budem to hlasit\r\n                // Musi se to ulozit, pokud chceme\r\n                if( self.$body.hasClass(\"sitg-sort-changed\") ){\r\n                    return \"Změnili jste řazení. Když jej neuložíte, nebude se zobrazovat.\";\r\n                }\r\n                //else if(){\r\n                    // Kdyz se obrazky promazou, ukladaji se data do post_meta\r\n                    // Tohle by se melo dit asi automaticky, aby na to uzivatel nemusel myslet\r\n                //}\r\n                else {\r\n                    delete e['returnValue'];\r\n                }\r\n\r\n            });\r\n*/\r\n            // Button, ktery otevira modalni okno s uploadem\r\n            self.$body.on(\"click\", \".sitg-modal-open\", function (e) {\r\n                self.$body.addClass(\"modal-open\");\r\n                self.$modalUploader.show();\r\n                // Init uploader\r\n                self.initUploader();\r\n                e.preventDefault();\r\n            });\r\n\r\n            // Rucne spustene nahravani fotek\r\n            self.$body.on(\"click\", \"#sitg-upload-start\", function(e){\r\n                self.$dragDropZone.dmUploader('start');\r\n                e.preventDefault();\r\n            });\r\n\r\n            // Rucne zastavime nahravani\r\n            self.$body.on(\"click\", \"#sitg-upload-cancel\", function(e){\r\n                self.$dragDropZone.dmUploader('cancel');\r\n                e.preventDefault();\r\n            });\r\n\r\n            // Smazani obrazku v modalu\r\n            self.$body.on(\"click\", \".sitg-modal-delete-file\", function(e){\r\n\r\n                var $this = $(this);\r\n\r\n                var id = $this.data(\"id\");\r\n\r\n                // Nejdriv zjistime, jestli uploadujeme nebo ne\r\n                // Kdyz spoustime upload - pridavame ty dragdrop zone tridu is-running\r\n                if( self.$dragDropZone.hasClass(\"is-running\") ){\r\n                    // Stop upload pro vybrany soubor\r\n                    // Bohuzel se uz muze neco nahrat nebo se to ulozi do DB\r\n                    // Meli bysme zaridit, aby se pripadny fragmenty smazaly taky\r\n                    self.$dragDropZone.dmUploader(\"cancel\", id);\r\n                }\r\n                // Kdyz mame ve fronte soubor, ktery neprosel validaci\r\n                // ma ten handler tridu delete-row-only\r\n                // Smazeme jen to HTML-ko\r\n                // Ve fronte to nemame\r\n                else if( $this.hasClass(\"delete-row-only\") ){\r\n                    $this.closest(\"li\").slideUp(200, function(){\r\n                        $this.remove();\r\n                    });\r\n                }\r\n                else {\r\n                    // Smazeme soubor z fronty pred uploadovanim\r\n                    // Metodu \"delete\" jsme do toho pluginu pridali - neaktulizovat!\r\n                    // Kdyz upload bezi, tahle metoda nedela nic\r\n                    // Soubor se z fronty odstrani, ale HTML tam zustane\r\n                    // To se musi zaridit tady\r\n                    self.$dragDropZone.dmUploader('delete', id);\r\n                    // Odstranime polozku ze seznamu v tom modalu\r\n                    $this.closest(\"li\").slideUp(200, function(){\r\n                        $this.remove();\r\n                    });\r\n                }\r\n\r\n                e.preventDefault();\r\n            });\r\n\r\n            // Button, ktery zavira modalni okno s uploadem\r\n            self.$body.on(\"click\", \".sitg-modal-close\", function (e) {\r\n                self.modalClose();\r\n                e.preventDefault();\r\n            });\r\n\r\n            // Razeni obrazků\r\n            self.$selectSort.on(\"change\", function(){\r\n                var vle = this.value;\r\n                self.ajaxGetImages( $(this), vle );\r\n                self.$body.addClass(\"sitg-sort-changed\");\r\n            });\r\n\r\n            // Zobrazit editaci obrazku\r\n            self.$body.on(\"click\", \".sitg-handler-edit\", function(e){\r\n                // Hide all\r\n                self.editImageClose();\r\n                // Show current\r\n                $(this).closest(\".sitg-mb-list-ui-handle\").find(\".sitg-mb-edit-layer\").addClass(\"is-open\").fadeIn(200);\r\n\r\n                e.preventDefault();\r\n            });\r\n\r\n            // Uloz zmeny editace nazvu obrazku\r\n            self.$body.on(\"click\", \".sitg-handler-edit-save\", function(e){\r\n                self.ajaxEditImageHandler( $(this) );\r\n\r\n                e.preventDefault();\r\n            });\r\n\r\n            // Uloz zmeny, kdyz se klepne na Enter v tom textovym poli\r\n            self.$body.on(\"keypress\", \".sitg-mb-edit-title\", function(e){\r\n                var keycode = (e.keyCode ? e.keyCode : e.which);\r\n                if( keycode == '13' ){\r\n                    self.ajaxEditImageHandler( $(this) );\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                }\r\n            });\r\n\r\n            // Zavrit editaci obrazku\r\n            self.$body.on(\"click\", \".sitg-handler-edit-close\", function(e){\r\n                // Pokud se ten novy nazev neulozi, vlozime do toho input pole ten stary\r\n                self.editImageCacheTitle( $(this) );\r\n                e.preventDefault();\r\n            });\r\n\r\n            // Zavri editaci obrazku pres klavesu ESC\r\n            self.$document.keydown(function (e) {\r\n                if (e.cancelable === true && e.key === 'Esc' || e.key === 'Escape' || e.keyCode === 27) {\r\n                    // Pokud se ten novy nazev neulozi, vlozime do toho input pole ten stary\r\n                    self.editImageCacheTitle( $(\".sitg-mb-edit-layer.is-open\") );\r\n                }\r\n            });\r\n\r\n            // Zavri editaci obrazku kdyz klepnes mimo\r\n            self.$body.on(\"mousedown\", function(e) {\r\n                var container = $(\".sitg-mb-edit-layer.is-open\");\r\n                if (!container.is(e.target) && container.has(e.target).length === 0){\r\n                    // Pokud se ten novy nazev neulozi, vlozime do toho input pole ten stary\r\n                    self.editImageCacheTitle( container );\r\n                }\r\n            });\r\n\r\n            // Oznaceni \"hlavniho\" obrazku\r\n            self.$body.on(\"click\", \".sitg-handler-featured\", function(){\r\n                self.ajaxSetFeaturedImage( $(this) );\r\n            });\r\n\r\n            // Mazani obrazku - vsech oznacenych\r\n            self.$btnDelete.on(\"click\", function(e){\r\n                // Vytahneme si vsechny oznacene obrazky\r\n                if( self.selectedItemsCache.length > 0 ) {\r\n                    // Chceme to nejdriv potvrdit\r\n                    self.confirmDialogShow(\"Máme je opravdu smazat?\", \"sitgDeleteSelected\");\r\n                }\r\n\r\n                e.preventDefault();\r\n            });\r\n\r\n            // Smazat vse\r\n            self.$btnDeleteAll.on(\"click\", function(e){\r\n                // Chceme to nejdriv potvrdit\r\n                self.confirmDialogShow(\"Smažeme je všechny?\", \"sitgDeleteAll\");\r\n                e.preventDefault();\r\n            });\r\n\r\n            self.$body.on(\"click\", \"#sitg-confirm-yes\", function(e){\r\n\r\n                var action = $(this).closest(\"#sitg-confirm-dialog\").data(\"action\");\r\n                self.$document.trigger( action );\r\n\r\n                e.preventDefault();\r\n            });\r\n\r\n            self.$body.on(\"click\", \"#sitg-confirm-no\", function(e){\r\n                self.confirmDialogHide();\r\n                e.preventDefault();\r\n            });\r\n\r\n            // Vlastni eventy\r\n            // ---------------------------------------------------\r\n            // sitgDeleteSelected pro mazani jen vybranych polozek\r\n            self.$document.on(\"sitgDeleteSelected\", function(){\r\n\r\n                var $items  = $(self.selectedItemsCache);\r\n                // Schovame dialog\r\n                self.confirmDialogHide();\r\n                // Pak je poslem pres ajax ke zpracovani\r\n                self.ajaxRemoveImagesHandler($items);\r\n                // Nakonec vysypeme cache s vybranyma polozkama\r\n                self.selectedItemsCache = [];\r\n\r\n            });\r\n            // sitgDeleteAll pro mazani vsech polozek\r\n            self.$document.on(\"sitgDeleteAll\", function(){\r\n                var $items  = self.$imagePreviewList.find(\".sitg-mb-list-ui-handle\");\r\n                self.confirmDialogHide();\r\n                self.ajaxRemoveImagesHandler( $items );\r\n            });\r\n\r\n            // Tohle se spousti jenom tehdy, pokud mame v metaboxu nejaky obrazky\r\n            if( self.$imagePreviewList.find(\".sitg-mb-list-ui-handle\").length ){\r\n\r\n                // Sortovani a vybirani\r\n                // https://github.com/SortableJS/Sortable\r\n                self.initSortable();\r\n            }\r\n\r\n        },\r\n\r\n        initSortable: function(){\r\n\r\n            var self = this;\r\n\r\n            // Nejdriv zabit potom ozivit\r\n            // Kdyz se nam zmeni DOM je to nutny\r\n            if( typeof self.sitgSortable !== \"undefined\" && self.sitgSortable !== \"\" ) {\r\n                self.sitgSortable.destroy();\r\n            }\r\n\r\n            // https://github.com/SortableJS/Sortable\r\n            // https://github.com/SortableJS/Sortable/tree/master/plugins/MultiDrag\r\n            self.sitgSortable = new Sortable( $(\"#sitg-image-preview-list\")[0], {\r\n                multiDrag: true,\r\n                selectedClass: \"ui-selected\",\r\n                // Pripneme to na element uvnitr .sitg-mb-list-ui-handle\r\n                // Protoze jinak se to da chytit i za ty okraje, coz je divny chovani\r\n                handle: \".sitg-mb-list-item\",\r\n                filter: \".sitg-mb-buttons\", // Tlacitko uvnitr\r\n                animation: 200,\r\n                // Kdyz se vybira a kdyz se sortuje, tak si ty vybrany polozky nahazime do promenny jako cache\r\n                // aby jsme o ne neprisli\r\n                // Kdyz se totiz klepne na tlacitko s nejakou akci, odznaci se to a nemuzeme tak nic posilat\r\n                // Niz je pak listener, ktery posloucha, jestli se kleplo na tlacitko nebo ne\r\n                // Tu cache pak vysypeme, kdyz se klepne mimo\r\n                // Vysypeme ji taky, kdyz se na tlacitko klepne, ale az potom, co se to posle PHP-cku\r\n                onSelect: function(evt){\r\n                    self.selectedItemsCache = evt.items;\r\n                },\r\n                onUpdate: function (evt){\r\n                    self.selectedItemsCache = evt.items;\r\n                    //self.ajaxUpdateSort();\r\n                }\r\n            });\r\n\r\n            // Kdyz se klepne mimo tlacitko delete tak se vymaze cache s oznacenyma obrazkama\r\n            self.$body.on(\"mousedown\", function(e) {\r\n                var container = $(\".sitg-btn-delete, #sitg-confirm-yes\");\r\n                if (!container.is(e.target) && container.has(e.target).length === 0){\r\n                    self.selectedItemsCache = [];\r\n                }\r\n            });\r\n\r\n        },\r\n\r\n        initUploader: function(){\r\n\r\n            var self = this;\r\n\r\n            self.$dragDropZone.dmUploader({\r\n\r\n                url: sitg_ajax.ajax_url,\r\n                extraData: {\r\n                    _ajax_nonce: sitg_ajax.nonce,\r\n                    action: 'sitg_ajax_upload',\r\n                    post_id: self.$dragDropZone.data(\"id\")\r\n                },\r\n                maxFileSize: sitg_ajax.max_upload_size,\r\n                allowedTypes: 'image/*',\r\n                extFilter: ['jpg', 'jpeg','png','gif'],\r\n                auto: false,\r\n                queue: true,\r\n\r\n                onDragEnter: function(){\r\n\r\n                    // Happens when dragging something over the DnD area\r\n                    this.addClass('active');\r\n\r\n                },\r\n                onDragLeave: function(){\r\n\r\n                    // Happens when dragging something OUT of the DnD area\r\n                    this.removeClass('active');\r\n\r\n                },\r\n                onInit: function(){\r\n\r\n                    // Plugin is ready to use\r\n                    self.ui_add_log('Penguin initialized :)', 'info');\r\n\r\n                },\r\n                onComplete: function(){\r\n\r\n                    // Kdyz je hotovo, odstranime tridu is-running, podle ni detekujeme, jestli to bezi nebo ne\r\n                    self.uploaderToggleClass();\r\n\r\n                    // All files in the queue are processed (success or error)\r\n                    self.ui_add_log('All pending tranfers finished');\r\n\r\n                },\r\n                onNewFile: function(id, file, validate){\r\n\r\n                    self.ui_multi_add_file(id, file, validate);\r\n\r\n                    if (typeof FileReader !== \"undefined\"){\r\n\r\n                        var reader = new FileReader();\r\n                        var img = $('#uploaderFile' + id).find('img');\r\n                        var $del = $('#uploaderFile' + id).find(\".sitg-modal-delete-file\");\r\n\r\n                        reader.onload = function (e) {\r\n                            img.attr( 'src', e.target.result );\r\n                            $del.data(\"id\", id);\r\n                        };\r\n\r\n                        reader.readAsDataURL( file );\r\n\r\n                    }\r\n\r\n                    // When a new file is added using the file selector or the DnD area\r\n                    self.ui_add_log('Nová fotka: #' + id);\r\n\r\n                },\r\n                onFileTypeError: function(file){\r\n\r\n                    self.ui_add_log('File \\'' + file.name + '\\' cannot be added: file type is not allowed', 'danger');\r\n\r\n                },\r\n                onBeforeUpload: function(id){\r\n\r\n                    // Pridame dragdrop zone tridu is-running pro detekci, jestli to bezi nebo ne\r\n                    self.uploaderToggleClass(\"run\");\r\n\r\n                    self.ui_multi_update_file_status(id, 'uploading', 'Nahrávání...');\r\n                    self.ui_multi_update_file_progress(id, 0, '', true);\r\n\r\n                    // about tho start uploading a file\r\n                    self.ui_add_log('Starting the upload of #' + id);\r\n\r\n                },\r\n                onUploadCanceled: function(id) {\r\n\r\n                    if( !id ){\r\n                        // Kdyz se stopne upload uplne - musime tu tridu odstranit\r\n                        self.uploaderToggleClass();\r\n                    }\r\n\r\n                    // Kdyz se to stopne, tak PHP-cko dal jede\r\n                    // Budem muset smazat co se nahralo\r\n                    console.log(\"canceled\");\r\n\r\n                    // Happens when a file is directly canceled by the user.\r\n                    self.ui_multi_update_file_status(id, 'warning', 'Nahrávání zrušeno');\r\n                    self.ui_multi_update_file_progress(id, 0, 'warning', false);\r\n\r\n                },\r\n                onUploadProgress: function(id, percent){\r\n\r\n                    // Updating file progress\r\n                    self.ui_multi_update_file_progress(id, percent);\r\n\r\n                },\r\n                onUploadSuccess: function(id, data){\r\n\r\n                    var data_str = JSON.stringify( data ),\r\n                        data_obj = JSON.parse( data_str );\r\n\r\n                    self.ajaxGetImage( data_obj.file_id );\r\n\r\n                    // Restartujeme ten sortable\r\n                    self.initSortable();\r\n\r\n                    self.ui_multi_update_file_status(id, 'success', 'Úspěšně jsme to nahráli :)');\r\n                    self.ui_multi_update_file_progress(id, 100, 'success', false);\r\n\r\n                    // A file was successfully uploaded\r\n                    self.ui_add_log('Server Response for file #' + id + ': ' + JSON.stringify(data));\r\n                    self.ui_add_log('Upload of file #' + id + ' COMPLETED', 'success');\r\n\r\n                },\r\n                onUploadError: function(id, xhr, status, message){\r\n\r\n                    self.ui_multi_update_file_status(id, 'danger', message);\r\n                    self.ui_multi_update_file_progress(id, 0, 'danger', false);\r\n\r\n                },\r\n                onFallbackMode: function(){\r\n\r\n                    // When the browser doesn't support this plugin :(\r\n                    self.ui_add_log('Plugin cant be used here, running Fallback callback', 'danger');\r\n\r\n                },\r\n                onFileSizeError: function( file ){\r\n\r\n                    self.ui_add_log('File \\'' + file.name + '\\' cannot be added: size excess limit', 'danger');\r\n                }\r\n\r\n            });\r\n\r\n        },\r\n\r\n        ui_multi_add_file: function( id, file, validate ) {\r\n\r\n            var self = this;\r\n\r\n            // Prenasime info o validaci\r\n            // V tom seznamu to zobrazime\r\n            // Musime ale zajistit, aby se ten soubor neobjevil ve fronte\r\n\r\n            // Do ty JS sablony vlozime jen obrazek a nazev a stav (proc nejde nahrat)\r\n            // Zbytek pujde do riti\r\n\r\n            self.$filesList.find('li.empty').fadeOut(); // remove the 'no files yet'\r\n\r\n            var template;\r\n\r\n            if( validate !== true ){\r\n                template = $(\"#no-validate-files-template\").text();\r\n                template = template.replace( \"%%validate_message%%\", validate.message );\r\n            }\r\n            else {\r\n                template = $(\"#files-template\").text();\r\n            }\r\n\r\n            template = template.replace( \"%%filename%%\", file.name );\r\n\r\n            template = $(template);\r\n            template.prop('id', 'uploaderFile' + id);\r\n            template.data('file-id', id);\r\n\r\n            self.$filesList.prepend(template);\r\n\r\n        },\r\n\r\n        // Updates a file progress, depending on the parameters it may animate it or change the color.\r\n        ui_multi_update_file_progress: function( id, percent, color, active ) {\r\n\r\n            color = (typeof color === 'undefined' ? false : color);\r\n            active = (typeof active === 'undefined' ? true : active);\r\n\r\n            var bar = $('#uploaderFile' + id).find('div.progress-bar');\r\n\r\n            bar.width(percent + '%').attr('aria-valuenow', percent);\r\n            bar.toggleClass('progress-bar-striped progress-bar-animated', active);\r\n\r\n            if (percent === 0){\r\n                bar.html('');\r\n            } else {\r\n                bar.html(percent + '%');\r\n            }\r\n\r\n            if (color !== false){\r\n                bar.removeClass('bg-success bg-info bg-warning bg-danger');\r\n                bar.addClass('bg-' + color);\r\n            }\r\n        },\r\n\r\n        // Changes the status messages on our list\r\n        ui_multi_update_file_status: function( id, status, message ) {\r\n\r\n            $('#uploaderFile' + id).find('.sitg-status').html(message).prop('class', 'sitg-status status text-' + status);\r\n\r\n        },\r\n\r\n        // Adds an entry to our debug area\r\n        ui_add_log: function(message, color) {\r\n\r\n            var d = new Date();\r\n\r\n            var dateString = ((\"0\" + d.getHours())).slice(-2) + \":\" +\r\n                ((\"0\" + d.getMinutes())).slice(-2) + \":\" +\r\n                ((\"0\" + d.getSeconds())).slice(-2);\r\n\r\n            color = (typeof color === \"undefined\" ? \"muted\" : color);\r\n\r\n            var template = $(\"#debug-template\").text();\r\n            template = template.replace(\"%%date%%\", dateString);\r\n            template = template.replace(\"%%message%%\", message);\r\n            template = template.replace(\"%%color%%\", color);\r\n\r\n            $(\"#debug\").find(\"li.empty\").fadeOut(); // remove the 'no messages yet'\r\n            $(\"#debug\").prepend(template);\r\n\r\n        },\r\n\r\n        ajaxGetImage: function( id ){\r\n\r\n            var self = this;\r\n\r\n            $.ajax({\r\n\r\n                url: sitg_ajax.ajax_url,\r\n                cache: false,\r\n                dataType: 'html',\r\n                data: {\r\n                    _ajax_nonce: sitg_ajax.nonce,\r\n                    action: 'sitg_ajax_get_image',\r\n                    pid: id\r\n                }\r\n\r\n            })\r\n            .done(function( data ){\r\n\r\n                // Odstranime hlasku, ze nejsou vybrany zadny obrazky\r\n                $(\"#no-images-meta-info\").remove();\r\n                // Vlozime obrazek\r\n                self.$imagePreviewList.append( data );\r\n\r\n            })\r\n            .fail(function( jqXHR, textStatus ){\r\n                console.log( 'SITg: AJAX error - ajaxGetImage() - ' + textStatus );\r\n            });\r\n\r\n        },\r\n\r\n        ajaxGetImages: function( $this, value ){\r\n\r\n            var self = this;\r\n\r\n            if( self.$ajaxGetImages )\r\n                return false;\r\n\r\n            self.$ajaxGetImages = $.ajax({\r\n                url: sitg_ajax.ajax_url,\r\n                method: \"POST\",\r\n                cache: false,\r\n                dataType: 'html',\r\n                data: {\r\n                    _ajax_nonce: sitg_ajax.nonce,\r\n                    action: 'sitg_ajax_get_images',\r\n                    post_id: $this.data(\"id\"),\r\n                    sort: value\r\n                }\r\n            })\r\n            .done(function( data ){\r\n                self.$imagePreviewList.html( data );\r\n                self.$ajaxGetImages = false;\r\n            })\r\n            .fail(function( jqXHR, textStatus ){\r\n                console.log( 'SITg: AJAX error - ajaxRemoveImages() - ' + textStatus );\r\n                self.$ajaxGetImages = false;\r\n            });\r\n\r\n        },\r\n\r\n        ajaxRemoveImagesHandler: function( $items ){\r\n\r\n            var self = this;\r\n\r\n            // Kdyby se podarilo klepnout na to mazani\r\n            // kdyz bezi ajax - musime to stopnout\r\n            if( self.$ajaxRemoveImages )\r\n                return false;\r\n\r\n            // Prazdny data nebudem resit\r\n            if( $items.length < 1 )\r\n                return false;\r\n\r\n            var img_ids = [];\r\n\r\n            // Sestavime seznam idcek\r\n            $items.each( function(i, e) {\r\n                img_ids[i] = $(this).data(\"pid\");\r\n            });\r\n\r\n            var i       = 0,\r\n                max     = img_ids.length;\r\n\r\n            function nextRemoveImg() {\r\n\r\n                if (i >= max) {\r\n\r\n                    // Az nam to dobehne, povolime dalsi akce\r\n                    self.$ajaxRemoveImages = false;\r\n\r\n                    // Aktualizujeme poradi v DB a na strance\r\n                    // Je tam animace toho mizeni obrazku\r\n                    // Musime tam dat kratsi timeout, nez se ten DIV odstrani uplne\r\n                    // To sortovani volame jednou, tak by to nemelo vadit\r\n                    //var t = setTimeout(function(){\r\n                    //    self.ajaxUpdateSort();\r\n                    //    clearTimeout(t);\r\n                    //}, 900 );\r\n\r\n                    return true;\r\n                }\r\n\r\n                $.ajax({\r\n                    url: sitg_ajax.ajax_url,\r\n                    method: \"POST\",\r\n                    cache: false,\r\n                    dataType: 'json',\r\n                    data: {\r\n                        _ajax_nonce: sitg_ajax.nonce,\r\n                        action: 'sitg_ajax_remove_one_image',\r\n                        pid: img_ids[i]\r\n                    }\r\n                })\r\n                .done(function( data ){\r\n\r\n                    onRemoveImgComplete( data );\r\n\r\n                })\r\n                .fail(function( jqXHR, textStatus ){\r\n                    console.log( 'SITg: AJAX error - ajaxRemoveImages() - ' + textStatus );\r\n                });\r\n\r\n            }\r\n\r\n            function onRemoveImgComplete( data ) {\r\n\r\n                //console.log( \"onRemoveImgComplete: \" + img_ids[i] );\r\n\r\n                // Kdyz se v PHP-cku nic nepokazi, vraci to 1\r\n                // jinak 0\r\n                // Nemelo by se to v tom seznamu nejak pekne zobrazit?\r\n                // Ze to jako nejde smazat?\r\n                if( data === 1 ){\r\n\r\n                    // Odstranime nahled obrazku ze seznamu\r\n                    var $item = $('[data-pid='+ img_ids[i] +']');\r\n                    // Nejdriv animujeme pruhlednost\r\n                    $item.find(\".sitg-mb-list-item\").fadeTo(150, 0, function(){\r\n                        // Jakmile to dojede animujeme sirku a vysku na nula\r\n                        $item.animate({ height: 0 }, 150, function(){\r\n                            $item.animate({ width: 0 }, 150, function(){\r\n                                // Nakonec smazeme element aby nam tam nedelal bordel\r\n                                $item.remove();\r\n                            });\r\n                        });\r\n                    });\r\n\r\n                }\r\n\r\n                i++;\r\n                nextRemoveImg();\r\n            }\r\n\r\n            // Prvni iteraci pustime rucne\r\n            nextRemoveImg();\r\n\r\n        },\r\n\r\n        ajaxEditImageHandler: function( $this ){\r\n\r\n            var self = this;\r\n\r\n            var $parent = $this.closest(\".sitg-mb-list-ui-handle\");\r\n            var $layer = $parent.find(\".sitg-mb-edit-layer\");\r\n            var title = $layer.find(\".sitg-mb-edit-title\").val();\r\n            var pid = $parent.data(\"pid\");\r\n\r\n            $.ajax({\r\n                url: sitg_ajax.ajax_url,\r\n                method: \"POST\",\r\n                cache: false,\r\n                dataType: 'json',\r\n                data: {\r\n                    _ajax_nonce: sitg_ajax.nonce,\r\n                    action: 'sitg_ajax_edit_image',\r\n                    pid: pid,\r\n                    title: title\r\n                }\r\n            })\r\n            .done(function( data ){\r\n\r\n                var $el = $('.sitg-mb-list-ui-handle[data-pid=\"'+ pid + '\" ]');\r\n\r\n                if( data.response > 0 ){\r\n                    $el.find(\".sitg-mb-list-item-title strong\").text( title );\r\n                    $el.find(\".sitg-mb-edit-title\").data(\"cache\", title );\r\n                    self.editImageClose();\r\n                }\r\n\r\n            })\r\n            .fail(function( jqXHR, textStatus ){\r\n                console.log( 'SITg: AJAX error - ajaxEditImageHandler() - ' + textStatus );\r\n            });\r\n\r\n        },\r\n\r\n        ajaxSetFeaturedImage: function( $this ){\r\n\r\n            var $this_closest_handle = $this.closest(\".sitg-mb-list-ui-handle\"),\r\n                selected = 0;\r\n\r\n            // Pokud klepneme na uz vybrany obrazek, odznacime ho\r\n            // php-cku posleme selected = 1\r\n            if( $this_closest_handle.hasClass(\"is-featured\") ){\r\n                selected = 1;\r\n            }\r\n\r\n            // Reset selected item\r\n            $(\".sitg-mb-list-ui-handle\").removeClass(\"is-featured\");\r\n\r\n            // Get IDs\r\n            var post_id = $(\"#sitg-image-preview-list\").data(\"post-id\");\r\n            var pid = $this_closest_handle.data(\"pid\");\r\n\r\n            // Call ajax\r\n            $.ajax({\r\n                url: sitg_ajax.ajax_url,\r\n                method: \"POST\",\r\n                cache: false,\r\n                data: {\r\n                    _ajax_nonce: sitg_ajax.nonce,\r\n                    action: 'sitg_ajax_set_featured_image',\r\n                    pid: pid,\r\n                    post_id: post_id,\r\n                    selected: selected\r\n                }\r\n            })\r\n            .done(function( data ){\r\n                console.log(data);\r\n                // Set current\r\n                if( data !== \"unselected\" ){\r\n                    $this_closest_handle.addClass(\"is-featured\");\r\n                }\r\n            })\r\n            .fail(function( jqXHR, textStatus ){\r\n                console.log( 'SITg: AJAX error - ajaxSetFeaturedImage() - ' + textStatus );\r\n            });\r\n\r\n        },\r\n\r\n        editImageCacheTitle: function( $this ){\r\n\r\n            var $parent, $input;\r\n\r\n            $(\".sitg-mb-edit-layer\").fadeOut(200, function(){\r\n                $parent = $this.closest(\".sitg-mb-list-ui-handle\");\r\n                $input = $parent.find(\".sitg-mb-edit-title\");\r\n                $input.val( $input.data(\"cache\") );\r\n                $(this).removeClass(\"is-open\");\r\n            });\r\n\r\n        },\r\n\r\n        editImageClose: function(){\r\n            $(\".sitg-mb-edit-layer\").fadeOut(200).removeClass(\"is-open\");\r\n        },\r\n\r\n        modalClose: function(){\r\n\r\n            var self = this;\r\n\r\n            // Zavreme okno a zabijeme ten uploader\r\n            self.$modalUploader.toggle();\r\n            self.$body.toggleClass(\"modal-open\");\r\n            self.$dragDropZone.dmUploader(\"destroy\");\r\n\r\n            // Vyprazdnime ten seznam nahranych fotech\r\n            self.$filesList.find(\".media\").remove();\r\n            self.$filesList.find(\".empty\").show();\r\n\r\n            // Seznam nahranych souboru hodime do metaboxu jako input hidden pole\r\n            // Cele to vygenerujeme z DB\r\n            // Co ale s obrazkama, ktery uz tam jsou?\r\n\r\n        },\r\n\r\n        confirmDialogShow: function( title, action ){\r\n\r\n            var self = this;\r\n\r\n            self.$body.addClass(\"modal-open\");\r\n\r\n            var template = $(\"#sitg-confirm-dialog-template\").text();\r\n                template = template.replace( \"%%title%%\", title );\r\n\r\n            var $template = $(template);\r\n\r\n                $template.addClass(\"show\");\r\n                $template.attr('data-action', action);\r\n\r\n                self.$body.prepend( $template );\r\n\r\n        },\r\n\r\n        confirmDialogHide: function(){\r\n            var self = this;\r\n            var $dialog = $(\"#sitg-confirm-dialog\");\r\n            $dialog.remove();\r\n            self.$body.removeClass(\"modal-open\");\r\n        },\r\n\r\n        uploaderToggleClass: function( state ){\r\n\r\n            var self = this;\r\n\r\n            if( state === \"run\" ){\r\n                $(\"#sitg-upload-cancel\").css({display: \"inline-block\"});\r\n                $(\"#sitg-modal-close-btn\").css({display:\"none\"});\r\n                self.$dragDropZone.addClass(\"is-running\");\r\n            }\r\n            else {\r\n                $(\"#sitg-upload-cancel\").css({display: \"none\"});\r\n                $(\"#sitg-modal-close-btn\").css({display:\"inline-block\"});\r\n                self.$dragDropZone.removeClass(\"is-running\");\r\n            }\r\n\r\n        },\r\n\r\n        bodyScrollClass: function(self){\r\n\r\n            var $el = $(\"#sit_custom_gallery\");\r\n\r\n            if( $el.length > 0 ) {\r\n                if (self.$document.scrollTop() > $(\"#sit_custom_gallery\").offset().top) {\r\n                    self.$body.addClass('sitg-stick-on');\r\n                } else {\r\n                    self.$body.removeClass('sitg-stick-on');\r\n                }\r\n            }\r\n\r\n        },\r\n        getHostname: function(url) {\r\n            var m = url.match(/^http:\\/\\/[^/]+/);\r\n            return m ? m[0] : null;\r\n        }\r\n\r\n    };\r\n\r\n    // Add core script to $.sitgApp so it can be extended\r\n    //$.sitgApp = SITg_app.prototype;\r\n\r\n    $(document).ready(function () {\r\n\r\n        // Initialize script\r\n        new SITg_app();\r\n\r\n    });\r\n\r\n})(jQuery);\r\n"]}